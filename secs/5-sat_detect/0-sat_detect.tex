\chapter{Catalyst Saturation and Aging Detection}
The surface concentration of viable voids $(\Gamma)$ is hypothesized to decrease with aging \cite{daya2018development,daya2020kinetic}. This effect is reflected in the lumped parameters of the dynamic model for $NO_x$ reduction
developed in the previous chapter (Figure~\ref{fig::no_x_switching}). The impact of $\Gamma$ reduction on parameter
estimates is more pronounced in the saturated catalyst model, as this model does not exhibit the noise amplification
caused by the backward difference present in the regression model of the unsaturated system. For $NO_x$ process dynamics
(\ref{eqn::NOX_process}) under catalyst saturation, $\sigma(k) = \Gamma$.
\begin{align}
    \implies \eta_{sat} (k+1) &=  \frac{u_1(k)}{F(k)} \tau_0 \; k_{scr}(T(k)) \; \Gamma (T(k))
        \label{eqn::nox_mdl}
\end{align}
%===
The above equation~(\ref{eqn::nox_mdl}) shows that the tailpipe $NO_x$ concentration becomes independent of urea dosing
under catalyst saturation. Polynomial approximations of the Arrhenius temperature dependence of the rate constant,
$k_{scr}$, and the concentration of viable voids, $\Gamma$ \cite{nova2014urea,ciardelli2004scr,joo2008study}, are used to obtain a linear in parameters model for the $NO_x$ process dynamics.
\begin{align}
    k_{scr}(T) &= A_{scr} e^{\lr{-\frac{E_{scr}}{RT}}} \approx \sum k_i T^i  \qquad i = 0, 1, \hdots
    \label{eqn::rate_const} \\
    \Gamma(T) &= S_1 e^{-S_2 T} \approx \sum r_i T^i \qquad i = 0, 1, \hdots
    \label{eqn::gamma}
\end{align}
%===
The above approximate models for temperature introduce dependence of the parameter estimates based on the temperature
range in the samples. For numerical stability \cite{press2003numerical}, the given temperature range is mapped to
$[-1,1]$, and Chebyshev polynomial bases \cite{trefethen2019approximation} are used instead of standard polynomials.
Incorporating equations (\ref{eqn::residence_time_mdl}) and (\ref{eqn::gamma}) into the $NO_x$ process dynamic model
(\ref{eqn::nox_mdl}),
\begin{align}
    \eta_{sat} (k+1) &= \phi_{sat}^T(T(k)) \; \theta_{sat}
    \label{eqn::regression} \\
    %===
    \phi_{sat} (k) &= \frac{u_1(k)}{F(k)} \underbrace{\bm{2\lr{\frac{T-T_0}{T_r}}^2-1 & \frac{T-T_0}{T_r} & 1}}_{\phi_2(T)}
    \label{eqn::phi_def} \\
    %===
    \text{where } \quad T_0 &= \frac{T_{max} + T_{min}}{2}, \quad T_r = \frac{T_{max} - T_{min}}{2} \notag
\end{align}
Rearranging the terms of equation (\ref{eqn::regression}), we get a quantity that involves the product of the rate
constant and the surface concentration of viable voids, $k_{scr} \Gamma$, i.e.,
\begin{align}
    \alpha_{sat} (k) &= \frac{F(k)}{u_1(k)} \eta_{sat} (k) = \tau_0 k_{scr}(T(k)) \Gamma(T(k)) = \phi_2(T(k))^T \theta_{sat}
    \label{eqn::alpha_sat}
\end{align}
\begin{figure}[!ht]
    \centering
    \includegraphics[width=\figWidth]{./figs/5-sat_detect/1_intro/alpha_sat_1.png}
    \caption{Time plot of $\alpha_{sat}$ for aged and degreened catalysts for RMC cycle}
    \label{fig::alpha_sat_1}
\end{figure}
The parameter $\alpha_{sat}$ can be estimated from the available measurements. A plot of $\alpha_{sat}$ over time reveals a significant decrease in its magnitude for an aged catalyst compared to a degreened catalyst. The preceding equation indicates that $\alpha_{sat}$ is solely temperature-dependent. When plotted as a function of temperature, the magnitude of $\alpha_{sat}$ is consistently and statistically lower for the aged catalyst than for the degreened catalyst in both Hot-FTP and RMC tests. These findings support the hypothesis that aging reduces the surface concentration of viable voids ($\Gamma$).
\begin{figure}[!ht]
    \centering
    \includegraphics[width=0.7\textwidth]{./figs/5-sat_detect/1_intro/alpha_sat.png}
    \caption{Estimated $\alpha_{sat}$ for an aged and a degreened catalyst for Hot-FTP and RMC cycles}
    \label{fig::alpha_sat_0}
\end{figure}
Thus, the parameter estimates statistically capture the aging effects on the catalyst. The next step is to develop a
statistical test for catalyst saturation and aging detection based on the parameter estimates. The test is designed to
be implemented in real-time on the engine control unit (ECU) of a vehicle, enabling on-board diagnostics for catalyst
health monitoring.

\input{secs/5-sat_detect/1-wald_test.tex}
\input{secs/5-sat_detect/2-param_dist.tex}
\input{secs/5-sat_detect/3-testcell_aging.tex}
\input{secs/5-sat_detect/4-truck_aging.tex}
\input{secs/5-sat_detect/5-unconstrained_results.tex}
\input{secs/5-sat_detect/6-detector_performance.tex}
